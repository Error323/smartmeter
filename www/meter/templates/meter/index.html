<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>
    Smartmeter overview - RPi
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script src="http://code.jquery.com/jquery-1.9.1.js" type="text/javascript"></script>
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="http://code.highcharts.com/highcharts-more.js"></script>
    <script src="http://code.highcharts.com/modules/exporting.js"></script>
    <script type="text/javascript">
    $(function() {
      $('#container').highcharts({
        chart: {
          type: 'gauge',
          plotBorderWidth: 1,
          plotBackgroundColor: {
            linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 },
            stops: [
            [0, '#FFF4C6'],
            [0.3, '#FFFFFF'],
            [1, '#FFF4C6']
            ]
          },
          plotBackgroundImage: null,
          height: 200
        },
      
        title: {
          text: 'Realtime meter'
        },
        
        pane: [{
          startAngle: -45,
          endAngle: 45,
          background: null,
          center: ['25%', '145%'],
          size: 300
        }, {
          startAngle: -45,
          endAngle: 45,
          background: null,
          center: ['75%', '145%'],
          size: 300
        }],         
      
        yAxis: [{
          min: 0,
          max: 3000,
          minorTickPosition: 'outside',
          tickPosition: 'outside',
          labels: {
            rotation: 'auto',
            distance: 20
          },
          plotBands: [{
            from: 2700,
            to: 3000,
            color: '#C02316',
            innerRadius: '100%',
            outerRadius: '105%'
          }],
          pane: 0,
          title: {
            text: 'Power<br/><span style="font-size:8px">Usage in watt</span>',
            y: -40
          }
        }, {
          min: 0,
          max: 1.5,
          minorTickPosition: 'outside',
          tickPosition: 'outside',
          labels: {
            rotation: 'auto',
            distance: 20
          },
          plotBands: [{
            from: 1.2,
            to: 1.5,
            color: '#C02316',
            innerRadius: '100%',
            outerRadius: '105%'
          }],
          pane: 1,
          title: {
            text: 'Gas<br/><span style="font-size:8px">Usage in m\u00B3</span>',
            y: -40
          }
        }],
        
        plotOptions: {
          gauge: {
          dataLabels: {
            enabled: false
          },
          dial: {
            radius: '100%'
          }
          }
        },
          
      
        series: [{
          data: [0],
          yAxis: 0
        }, {
          data: [0],
          yAxis: 1
        }]
      
      },
      
      function(chart) {
        setInterval(function() {
          $.getJSON('realtime/', function(data) {
            var power = chart.series[0].points[0];
            var gas   = chart.series[1].points[0];
            power.update(data.power, false);
            gas.update(data.gas, false);
            chart.redraw();
          })
        }, 10000);
      });
    });
    </script>
  </head>
  <body>
    <div id="container" style="width: 600px; height: 300px; margin: 0 auto"></div>
  </body>
</html>
